!function(){"use strict";angular.module("mqtt",["ngRoute","ngAnimate","ui.bootstrap","toastr"])}(),function(){"use strict";function t(t,e,n){t.html5Mode({enabled:!0,requireBase:!1}),n.defaults.cache=!0,e.when("/",{templateUrl:"view/login/login.html",controller:"loginCtrl as Ctrl"}).when("/topics",{templateUrl:"view/topics/topics.html",controller:"topicsCtrl as Ctrl"}).when("/send",{templateUrl:"view/send/send.html",controller:"sendCtrl as Ctrl"}).when("/messages",{templateUrl:"view/messages/messages.html",controller:"messagesCtrl as Ctrl"}).otherwise("/")}t.$inject=["$locationProvider","$routeProvider","$httpProvider"],angular.module("mqtt").config(t)}(),function(){"use strict";angular.module("mqtt").constant("mqttConstants",{API_SERVER_URL:"http://localhost:8888",API_CONNECT_URL:"/connect",API_DISCONNECT_URL:"/disconnect",API_PUBLISH_URL:"/publish",API_SUBSCRIBE_URL:"/subscribe",API_UNSUBSCRIBE_URL:"/unsubscribe",API_MESSAGES_URL:"/getmessages",API_TOPICS_URL:"/gettopics"})}(),function(){"use strict";function t(t,e,n,o,s){function i(s){t.post(e.API_SERVER_URL+e.API_CONNECT_URL,s).then(function(t){return t.data.length<1?void o.error("Login failed!"):(n.path("/topics"),console.log(t),void o.success("Successfully logged in!",t))},function(t){console.log(t),o.error(t.data,"Oops some error here!")})["catch"](function(t){})}function c(s){t.post(e.API_SERVER_URL+e.API_DISCONNECT_URL,s).then(function(t){n.path("/"),o.success("Successfully logged out!",t)},function(t){o.error(t.data,"Oops some error here!")})["catch"](function(t){console.log(t)})}function r(n){var i=s.defer();return t.post(e.API_SERVER_URL+e.API_MESSAGES_URL,n).then(function(t){i.resolve(t)},function(t){o.error(t.data,"Oops some error in getting messages!")})["catch"](function(t){}),i.promise}function u(n){t.post(e.API_SERVER_URL+e.API_PUBLISH_URL,n).then(function(t){o.success("Successfully published!",t)},function(t){o.error(t.data,"Oops some error here!")})["catch"](function(t){})}function a(n){var i=s.defer();return t.post(e.API_SERVER_URL+e.API_TOPICS_URL,n).then(function(t){i.resolve(t)},function(t){console.log(t),o.error(t.data,"Oops some error here!")})["catch"](function(t){}),i.promise}function l(n){console.log(n);var i=s.defer();return t.post(e.API_SERVER_URL+e.API_SUBSCRIBE_URL,n).then(function(t){i.resolve(t),console.log(t),o.success("Successfully subscribed!")})["catch"](function(t){console.log(t)}),i.promise}function f(n){console.log(n);var i=s.defer();return t.post(e.API_SERVER_URL+e.API_UNSUBSCRIBE_URL,n).then(function(t){i.resolve(t),console.log(t),o.success("Successfully unsubscribed!")})["catch"](function(t){console.log(t)}),i.promise}return{connect:i,getMessages:r,publish:u,getTopics:a,subscribe:l,unsubscribe:f,disconnect:c}}t.$inject=["$http","mqttConstants","$location","toastr","$q"],angular.module("mqtt").factory("dataFactory",t)}(),function(){"use strict";function t(t,e,n){function o(){return"undefined"==typeof u&&(u=angular.fromJson(sessionStorage.getItem("mqttSession"))),"undefined"==typeof u||null==u?(t.warning("First please log in!"),void e.path("/")):u}function s(t){sessionStorage.setItem("mqttSession",angular.toJson(t)),"undefined"==typeof t&&sessionStorage.removeItem("mqttSession"),u=t}function i(t){a=[];for(var e=0;e<t.length;e++){for(var n=0,o=0;o<a.length;o++)a[o].topic==t[e].subscribtion.topic&&(n=1);1!=n&&a.push(t[e].subscribtion),n=0}}function c(t){var e=a.indexOf(t);a.splice(e,1)}function r(){return a}return{getSessionData:o,setSessionData:s,pushTopic:i,popTopic:c,getTopics:r};var u,a}t.$inject=["toastr","$location","dataFactory"],angular.module("mqtt").factory("sessionFactory",t)}(),function(){"use strict";function t(t,e,n,o){function s(){n.disconnect(r),o.setSessionData()}function i(){r=o.getSessionData()}var c=this,r={};c.exit=s,t.route=e.$$url,i()}t.$inject=["$scope","$location","dataFactory","sessionFactory"],angular.module("mqtt").controller("indexCtrl",t)}(),function(){"use strict";function t(t,e){function n(){e.setSessionData(s.login),t.connect(s.login)}function o(){}var s=this;s.login={isClean:!1,will:{retain:!1}},s.connect=n,o()}t.$inject=["dataFactory","sessionFactory"],angular.module("mqtt").controller("loginCtrl",t)}(),function(){"use strict";function t(t,e,n,o,s,i){function c(){t.getMessages({directions:["in","out"],topics:m,username:f.username}).then(function(t){l.messages=t.data})["catch"](function(t){n.error(t,"Oops some error here!")})}function r(){var n=i.defer();return t.getTopics({username:f.username}).then(function(t){t.data.length>0&&e.pushTopic(t.data),n.resolve()}),n.promise}function u(){f=e.getSessionData(),r().then(function(){for(var t=e.getTopics(),n=0;n<t.length;n++)m.push(t[n].topic);c()}),"undefined"!=typeof f&&(a=setInterval(c,2e3))}var a,l=this,f={},m=[];l.messages=[],s.$on("$routeChangeStart",function(){clearInterval(a)}),u()}t.$inject=["dataFactory","sessionFactory","toastr","$location","$rootScope","$q"],angular.module("mqtt").controller("messagesCtrl",t)}(),function(){"use strict";function t(t,e){function n(e){i.message.username=s.username,t.publish(i.message)}function o(){s=e.getSessionData()}var s,i=this;i.message,i.publish=n,i.message={retain:!1,isDupe:!1},o()}t.$inject=["dataFactory","sessionFactory"],angular.module("mqtt").controller("sendCtrl",t)}(),function(){"use strict";function t(t,e,n){function o(t){"undefined"!=typeof t.item&&e.unsubscribe({topics:[t.item.topic],username:r.username}).then(function(t){setTimeout(function(){i()},2e3),document.body.click()})}function s(){"undefined"!=typeof u.newItem.qos&&"undefined"!=typeof u.newItem.topic&&e.subscribe({topics:[u.newItem],username:r.username}).then(function(t){setTimeout(function(){i()},1e3),u.newItem={},document.body.click()})}function i(){e.getTopics({username:r.username}).then(function(t){t.data.length>0&&n.pushTopic(t.data),u.topics=[],u.topics=n.getTopics()})}function c(){r=n.getSessionData(),r&&i()}var r,u=this;u.topics=[],u.newItem={},u.deleteItem=o,u.addItem=s,t.popover={templateUrl:"/view/topics/modal.html",title:"Add new topic"},t.deletePopover={templateUrl:"/view/topics/popoverDelete.html",title:"Unsubscribe from topic?"},c()}t.$inject=["$scope","dataFactory","sessionFactory"],angular.module("mqtt").controller("topicsCtrl",t)}(),function(){"use strict";function t(t,e){function n(){function n(){o.route=t.$$url}var o=this;n(),e.$on("$routeChangeSuccess",function(){o.route=t.$$url})}function o(){}return{bindToController:!0,controller:n,controllerAs:"Ctrl",link:o,restrict:"AE",scope:{},templateUrl:"assets/directives/navigation.html"}}t.$inject=["$location","$rootScope"],angular.module("mqtt").directive("navigation",t)}();