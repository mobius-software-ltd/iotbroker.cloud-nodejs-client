{"version":3,"sources":["view/topics/topicsCtrl.js"],"names":[],"mappings":"AAAA,CAAC,WAAW;IACR;;IAEA,WAAW,UAAU,CAAC,UAAU,eAAe;IAC/C;SACK,OAAO;SACP,WAAW,cAAc;;;IAG9B,SAAS,WAAW,QAAQ,aAAa,gBAAgB;QACrD,IAAI,KAAK;QACT,IAAI;;QAEJ,GAAG,SAAS;QACZ,GAAG,UAAU;QACb,GAAG,aAAa;QAChB,GAAG,UAAU;;;QAGb,OAAO,UAAU;YACb,aAAa;YACb,OAAO;;;QAGX,OAAO,gBAAgB;YACnB,aAAa;YACb,OAAO;;;QAGX;;QAEA,SAAS,WAAW,QAAQ;;YAExB,IAAI,OAAO,OAAO,QAAQ,aAAa;YACvC,YAAY,YAAY;gBACpB,QAAQ,CAAC,OAAO,KAAK;gBACrB,UAAU,YAAY;eACvB,KAAK,SAAS,MAAM;gBACnB,WAAW,WAAW;oBAClB;;mBAED;gBACH,SAAS,KAAK;;;;QAItB,SAAS,UAAU;;YAEf,IAAI,OAAO,GAAG,QAAQ,OAAO,eAAe,OAAO,GAAG,QAAQ,SAAS,aAAa;YACpF,YAAY,UAAU;gBAClB,QAAQ,CAAC,GAAG;gBACZ,UAAU,YAAY;eACvB,KAAK,SAAS,MAAM;gBACnB,WAAW,WAAW;oBAClB;mBACD;gBACH,GAAG,UAAU;gBACb,SAAS,KAAK;;;;QAItB,SAAS,YAAY;YACjB,YAAY,UAAU;gBAClB,UAAU,YAAY;eACvB,KAAK,SAAS,MAAM;gBACnB,IAAI,KAAK,KAAK,SAAS,GAAG;oBACtB,eAAe,UAAU,KAAK;;gBAElC,GAAG,SAAS;gBACZ,GAAG,SAAS,eAAe;;;;QAInC,SAAS,OAAO;YACZ,cAAc,eAAe;YAC7B,IAAI,CAAC,CAAC;gBACF;;;;;KAKX","sourcesContent":["(function() {\n    'use strict';\n\n    topicsCtrl.$inject = [\"$scope\", \"dataFactory\", \"sessionFactory\"];\n    angular\n        .module('mqtt')\n        .controller('topicsCtrl', topicsCtrl)\n\n    /** @ngInject */\n    function topicsCtrl($scope, dataFactory, sessionFactory) {\n        var vm = this;\n        var sessionData;\n\n        vm.topics = [];\n        vm.newItem = {};\n        vm.deleteItem = deleteItem;\n        vm.addItem = addItem;\n\n\n        $scope.popover = {\n            templateUrl: '/view/topics/modal.html',\n            title: 'Add new topic'\n        };\n\n        $scope.deletePopover = {\n            templateUrl: '/view/topics/popoverDelete.html',\n            title: 'Unsubscribe from topic?'\n        };\n\n        init();\n\n        function deleteItem(params) {\n            // console.log(params.item);\n            if (typeof params.item == 'undefined') return;\n            dataFactory.unsubscribe({\n                topics: [params.item.topic],\n                username: sessionData.username\n            }).then(function(data) {\n                setTimeout(function() {\n                    getTopics();\n                    // console.log(vm.topics);\n                }, 2000);\n                document.body.click();\n            });\n        }\n\n        function addItem() {\n            // console.log(vm.newItem);\n            if (typeof vm.newItem.qos == 'undefined' || typeof vm.newItem.topic == 'undefined') return;\n            dataFactory.subscribe({\n                topics: [vm.newItem],\n                username: sessionData.username\n            }).then(function(data) {\n                setTimeout(function() {\n                    getTopics();\n                }, 1000);\n                vm.newItem = {};\n                document.body.click();\n            });\n        }\n\n        function getTopics() {\n            dataFactory.getTopics({\n                username: sessionData.username\n            }).then(function(data) {\n                if (data.data.length > 0) {\n                    sessionFactory.pushTopic(data.data);\n                }\n                vm.topics = [];\n                vm.topics = sessionFactory.getTopics();\n            });\n        }\n\n        function init() {\n            sessionData = sessionFactory.getSessionData();\n            if (!!sessionData)\n                getTopics();\n        }\n\n    }\n\n}());"],"file":"../../../view/topics/topicsCtrl.js"}